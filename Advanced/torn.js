var tableData = 
[
    {
        "id" : 274,
        "name" : "Panda Plushie",
        "Location": "China",
        "Time": 484,
        "Buy": 400,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":484,
        "airstrip":338,
        "private":242,
        "business":144,
    },
    {
        "id" : 276,
        "name" : "Peony Flower",
        "Location": "China",
        "Time": 484,
        "Buy": 5000,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":484,
        "airstrip":338,
        "private":242,
        "business":144,
    },
    {
        "id" : 269,
        "name" : "Monkey Plushie",
        "Location": "Argentina",
        "Time": 334,
        "Buy": 400,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":334,
        "airstrip":234,
        "private":166,
        "business":100,
    },
    {
        "id" : 271,
        "name" : "Ceibo Flower",
        "Location": "Argentina",
        "Time": 334,
        "Buy": 500,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":334,
"airstrip":234,
"private":166,
"business":100,
    },
    {
        "id":261,
        "name" : "Wolverine Plushie",
        "Location": "Canada",
        "Time": 82,
        "Buy": 30,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":82,
"airstrip":58,
"private":40,
"business":24,
    },
    {
        "id" : 263,
        "name" : "Crocus Flower",
        "Location": "Canada",
        "Time": 82,
        "Buy": 600,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":82,
"airstrip":58,
"private":40,
"business":24,
    },
    {
        "id" : 618,
        "name" : "Stingray Plushie",
        "Location": "Cayman Island",
        "Time": 70,
        "Buy": 400,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":70,
"airstrip":50,
"private":36,
"business":22,
    },
    {
        "id" : 617,
        "name" : "Banana Orchid",
        "Location": "Cayman Island",
        "Time": 70,
        "Buy": 4000,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":70,
"airstrip":50,
"private":36,
"business":22,
    },
    {
        "id" : 264,
        "name" : "Orchid Flower",
        "Location": "Hawaii",
        "Time": 268,
        "Buy": 700,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":268,
"airstrip":188,
"private":134,
"business":80,
    },
    {
        "id" : 277,
        "name" : "Cherry Blossom",
        "Location": "Japan",
        "Time": 225,
        "Buy": 500,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":225,
"airstrip":316,
"private":226,
"business":136,
    },
    {
        "id" : 258,
        "name" : "Jaguar Plushie",
        "Location": "Mexico",
        "Time": 52,
        "Buy": 10000,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":52,
"airstrip":36,
"private":26,
"business":16,
    },
    {
        "id" : 260,
        "name" : "Dahlia Flower",
        "Location": "Mexico",
        "Time": 52,
        "Buy": 300,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":52,
"airstrip":36,
"private":26,
"business":16,
    },
    {
        "id" : 281,
        "name" : "Lion Plushie",
        "Location": "Africa",
        "Time": 596,
        "Buy": 400,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":596,
"airstrip":416,
"private":298,
"business":178,
    },
    {
        "id" : 282,
        "name" : "African Violet",
        "Location": "Africa",
        "Time": 596,
        "Buy": 2000,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":596,
"airstrip":416,
"private":298,
"business":178,
    },
    {
        "id" : 273,
        "name" : "Chamois Plushie",
        "Location": "Switzerland",
        "Time": 350,
        "Buy": 400,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":350,
"airstrip":246,
"private":176,
"business":106,
    },
    {
        "id" : 272,
        "name" : "Edelweiss Flower",
        "Location": "Switzerland",
        "Time": 350,
        "Buy": 900,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":350,
"airstrip":246,
"private":176,
"business":106,
    },
    {
        "id" : 384,
        "name" : "Camel Plushie",
        "Location": "UAE",
        "Time": 542,
        "Buy": 14000,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":542,
"airstrip":380,
"private":270,
"business":162,
    },
    {
        "id" : 385,
        "name" : "Tribulus Omanense",
        "Location": "UAE",
        "Time": 542,
        "Buy": 6000,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":542,
"airstrip":380,
"private":270,
"business":162,
    },
    {
        "id" : 268,
        "name" : "Red Fox Plushie",
        "Location": "UK",
        "Time": 318,
        "Buy": 1000,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":318,
"airstrip":222,
"private":160,
"business":96,
    },
    {
        "id" : 266,
        "name" : "Nessie Plushie",
        "Location": "UK",
        "Time": 318,
        "Buy": 200,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":318,
"airstrip":222,
"private":160,
"business":96,
    },
    {
        "id" : 267,
        "name" : "Heather Flower",
        "Location": "UK",
        "Time": 318,
        "Buy": 5000,
        "Market": null,
        "Profit": null,
        "ProfitMin" : null,
        "standard":318,
"airstrip":222,
"private":160,
"business":96,
    }
]

let markett = []
function buildTable(){
    var table = document.getElementById("table-body");
    table.innerHTML = ''; 
    for ( const i in tableData){
        let row = ` 
            <tr>
                <td>${tableData[i].name}</td>
                <td>${tableData[i].Location}</td>
                <td>${tableData[i].Time}</td>
                <td>$${tableData[i].Buy}</td>
    
                <td>$${tableData[i].Market}</td>
                <td>$${tableData[i].Profit}</td>
                <td>$${tableData[i].ProfitMin} / minute</td>
            </tr>
        `

        table.innerHTML += row
    }
}
$("th").on("click",function(){
    var column = $(this).data('column')
    var order = $(this).data('order')
    var text = $(this).html()
    text = text.substring(0, text.length - 1)


    if(order == 'desc'){
        $(this).data('order', "asc")
        tableData = tableData.sort((a,b) => a[column] > b[column] ? 1 : -1)
        text += '&#9650'

    }else if (order == 'asc'){
        $(this).data("order","desc")
        tableData = tableData.sort((a,b)=> a[column] < b[column] ? 1 : -1)
        text += '&#9660'
    }
 
    $(this).html(text)
    buildTable(tableData);

})


const standard = document.getElementById("standard");
const airstrip = document.getElementById("airstrip");
const private = document.getElementById("private");
const business = document.getElementById("business");

standard.addEventListener("click",function(){

    for (const record in tableData){
        tableData[record].Time = tableData[record].standard;
    }
    standard.className = "primary";
    airstrip.className = "secondary";
    private.className = "secondary";
    business.className = "secondary";
    changeJson(markett);

    
});
airstrip.addEventListener("click",function(){

    for (const record in tableData){
        tableData[record].Time = tableData[record].airstrip;
    }
    standard.className = "secondary";
    airstrip.className = "primary";
    private.className = "secondary";
    business.className = "secondary";
    changeJson(markett);


});
private.addEventListener("click",function(){

    for (const record in tableData){
        tableData[record].Time = tableData[record].private;
    }
    standard.className = "secondary";
    airstrip.className = "secondary";
    private.className = "primary";
    business.className = "secondary";
    changeJson(markett);

});
business.addEventListener("click",function(){

    for (const record in tableData){
        tableData[record].Time = tableData[record].business;
    }

    standard.className = "secondary";
    airstrip.className = "secondary";
    private.className = "secondary";
    business.className = "primary";
    changeJson(markett);
    

});
function changeJson(objectData){
    for (const record in tableData){

        tableData[record].ProfitMin = Math.round((objectData.items[tableData[record].id].market_value-objectData.items[tableData[record].id].buy_price)/tableData[record].Time);
        buildTable(tableData);
    };
}




var postAPI = 'https://api.torn.com/torn/?selections=items&key=stMH09tVszuzuzqp';
fetch(postAPI)
.then(function(response){
    return response.json();
}).then(function(objectData){
    markett = objectData;
    for(const record in tableData){
        tableData[record].Market = objectData.items[tableData[record].id].market_value;
        tableData[record].Profit = objectData.items[tableData[record].id].market_value-objectData.items[tableData[record].id].buy_price;
        tableData[record].ProfitMin = Math.round((objectData.items[tableData[record].id].market_value-objectData.items[tableData[record].id].buy_price)/tableData[record].Time);
    }
buildTable(tableData);

    
}).catch(function(error){
    console.log("err");
})
